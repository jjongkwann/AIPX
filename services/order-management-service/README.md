# 주문 관리 서비스 (Order Management Service - OMS)

**OMS**는 전략 엔진에서 생성된 주문 요청을 받아 실제 증권사 API로 전송하는 **실행 전담** 서비스입니다. 주문의 유효성을 검증하고, 리스크를 관리하며, API 호출 속도를 조절합니다.

## 🛠 주요 기능 (Features)

### 1. gRPC 스트리밍 서버
-   **양방향 통신**: 전략 엔진과 gRPC Bidirectional Streaming으로 연결되어, 주문 요청과 체결 응답을 실시간으로 주고받습니다.
-   **저지연 처리**: HTTP 오버헤드 없이 마이크로초 단위의 통신 속도를 제공합니다.

### 2. 리스크 엔진 (Risk Engine)
주문이 외부로 나가기 전, 다음 규칙들을 검사하여 **팻 핑거(Fat Finger)** 사고를 방지합니다.
-   **주문 금액 한도**: 1회 주문 금액이 설정된 한도를 초과하는지 검사.
-   **가격 괴리율**: 현재가 대비 터무니없이 높거나 낮은 가격인지 검사.
-   **일일 손실 한도**: 당일 누적 손실이 허용치를 넘었는지 검사.

### 3. 속도 제한 (Rate Limiting)
-   **토큰 버킷 알고리즘**: KIS API의 초당 요청 제한(TPS)을 엄격히 준수합니다.
-   **우선순위 큐**: 제한 도달 시, 신규 주문보다 청산(매도) 주문을 우선적으로 처리합니다.

### 4. 스마트 주문 라우팅 (Smart Order Routing)
-   **API 규격 변환**: 내부 `OrderRequest` 객체를 KIS REST API JSON 포맷으로 변환합니다.
-   **에러 핸들링**: API 호출 실패 시, 에러 코드를 분석하여 재시도 가능한 에러인지 판단합니다.

## 🚀 시작하기 (Getting Started)

### 초기화
```bash
go mod tidy
```

### 실행
```bash
go run main.go
```
